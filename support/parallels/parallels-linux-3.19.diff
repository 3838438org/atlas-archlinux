Parallels Tools patch for Linux kernel >=3.19 (yes, 4.0-compatible!)
Source: https://forum.parallels.com/threads/temporary-fix-for-kernel-3-19.328277

--- kmods/prl_fs/SharedFolders/Guest/Linux/prl_fs/file.c
+++ kmods/prl_fs/SharedFolders/Guest/Linux/prl_fs/file.c
@@ -19,7 +19,7 @@
 	char *buf, *p;
 	int buflen, ret;
 	struct super_block *sb = inode->i_sb;
-	struct dentry *dentry = filp->f_dentry;
+	struct dentry *dentry = filp->f_path.dentry;
 	struct prlfs_file_info pfi;
 	struct prlfs_fd *pfd;

@@ -100,9 +100,9 @@
 	u8 type;

 	DPRINTK("ENTER\n");
-	assert(filp->f_dentry);
-	assert(filp->f_dentry->d_sb);
-	sb = filp->f_dentry->d_sb;
+	assert(filp->f_path.dentry);
+	assert(filp->f_path.dentry->d_sb);
+	sb = filp->f_path.dentry->d_sb;
 	offset = 0;
 	ret = 0;

@@ -182,9 +182,9 @@
 		filp->f_pos,
 #endif
 		0);
-	assert(filp->f_dentry);
-	assert(filp->f_dentry->d_sb);
-	sb = filp->f_dentry->d_sb;
+	assert(filp->f_path.dentry);
+	assert(filp->f_path.dentry->d_sb);
+	sb = filp->f_path.dentry->d_sb;
 	buflen = PAGE_SIZE;
 	buf = kmalloc(buflen, GFP_KERNEL);
 	if (buf == NULL) {
@@ -238,7 +238,7 @@
 	}
 	ret = 0;
 	init_pfi(&pfi, PFD(filp)->fd, PFD(filp)->sfid, *off, rw);
-	dentry = filp->f_dentry;
+	dentry = filp->f_path.dentry;

 	if (size == 0)
 		goto out;
@@ -269,7 +269,7 @@
 								 loff_t *off)
 {
 	ssize_t ret;
-	struct dentry *dentry = filp->f_dentry;
+	struct dentry *dentry = filp->f_path.dentry;
 	struct inode *inode = dentry->d_inode;

 #if LINUX_VERSION_CODE >= KERNEL_VERSION(2,6,16)


--- kmods/prl_fs/SharedFolders/Guest/Linux/prl_fs/inode.c
+++ kmods/prl_fs/SharedFolders/Guest/Linux/prl_fs/inode.c
@@ -660,7 +660,6 @@
                                               struct nameidata *nd)
 {
 #if LINUX_VERSION_CODE >= KERNEL_VERSION(2,6,0)
-	nd->depth = 0;
 	nd_set_link(nd, do_read_symlink(dentry));
 #endif


--- kmods/prl_tg/Toolgate/Guest/Linux/prl_tg/prltg.c
+++ kmods/prl_tg/Toolgate/Guest/Linux/prl_tg/prltg.c
@@ -803,7 +803,7 @@
 prl_tg_write(struct file *file, const char __user *buf, size_t nbytes,
 								 loff_t *ppos)
 {
-	const struct inode *ino = file->f_dentry->d_inode;
+	const struct inode *ino = file_inode(file);
 	struct tg_dev *dev = PDE_DATA(ino);
 	TG_REQ_DESC sdesc;
 	TG_REQUEST hdr, *src;
